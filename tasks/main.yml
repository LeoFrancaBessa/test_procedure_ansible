- name: MAIN | Get sensivel data from vault
  ansible.builtin.set_fact:
    db_sgbd: "{{ logi | community.general.json_query(jq + '.sgbd') }}"
    #db_sgbd: "dev"
    db_host: "{{ logi | community.general.json_query(jq + '.host' ) }}"
    #db_host: "10.1.1.80"
    db_port: "{{ logi | community.general.json_query(jq + '.port') }}"
    db_user: "{{ logi | community.general.json_query(jq + '.username') }}"
    db_pass: "{{ logi | community.general.json_query(jq + '.password') }}"
  vars:
    jq: "db[?name == '{{ DB_NAME }}'] | [0]"
  tags:
    - always

- name: PRINT | Show database variables
  ansible.builtin.debug:
    msg:
      - "DB SGBD: {{ db_sgbd }}"
      - "DB Host: {{ db_host }}"
      - "DB Port: {{ db_port }}"
      - "DB User: {{ db_user }}"
      - "DB Pass: {{ db_pass }}"
  tags:
    - always
